# TDD(Test Driven Development)

인터페이스를 테스트로 먼저 정의하고 나서 구현해나가는 개발 방식이다. 여기서 인터페이스란 소프트웨어가 작동하는 방식을 정의한 것이고 입력, 출력, 동작이 포함된다. 스펙은 말그대로 상세한 설명이다. 따라서 구현 전에 테스트를 작성하는 것은 소프트웨어가 작동하는 방식을 상세하게 설명하여 개발자가 요구사항을 숙지할 수 있게 도와주고 비교적 집중력을 잃지 않고 개발해 나갈 수 있다. 그리고 테스트 성공/실패 여부를 통해 구현체가 요구사항을 충족하는지 확인할 수 있어서 디버깅 시간을 줄일 수 있다.

TDD는 암묵적으로 이뤄지는 개발자의 사고 과정을 작은 단계로 나누고, 각 단계를 코드로 작성하여 검증하면서 개발을 진행할 수 있게 해준다. 따라서 복잡한 문제도 상대적으로 쉽고 안정적으로 해결할 수 있다. 나아가 더 좋은 설계에 대한 고민을 할 수 있게 해준다.

다른 장점으로는 다른 사람의 작업물을 망가뜨리지 않았다는 안정감 확보가 있다. 자동화된 단위 테스트 및 통합 테스트 코드는 개발자에게 자신감을 준다.

## TDD Cycle

Red -> Green -> Refactor 사이클을 반복하면서 구현한다. 만약 해당 사이클에 따라 구현을 하기 어렵다면 일반적인 개발이나 클린 코드를 작성하는 것 역시 힘들 가능성이 높다.

### Red

구현 없이 인터페이스와 스펙을 나타내는 실패하는 테스트를 작성한다.

### Green

테스트를 통과하는 최소한의 코드를 작성한다. 올바른 방법이 아니어도 괜찮다. 만약 테스트를 통과하는 코드를 작성하기 어렵다면, Red 단계로 돌아가 기존에 정의한 문제를 더 작고 쉬운 문제로 분할하고 테스트를 작성한 뒤에 구현을 시작한다.

### Refactor

리팩터링을 통해 코드를 개선한다. 의도를 드러내고 중복을 찾아 제거하는 작업을 수행한다.

## 생각 또는 경험

### TDD 도입의 전제조건

올바른 결과가 무엇인지 알기 어렵고 팀원들의 생각이 다르다면 TDD를 도입하기 어렵다. 우리가 무얼 만들고 있고, 어떻게 이뤄낼 것이며, 이번에 할 작업과 오늘 할 작업은 무엇이며, 이 결정이 내일 만들어낼 상황에 대한 이해와 공감이 없다면 TDD는 도입하기 어렵다.

따라서 TDD는 필연적으로 더 많은 결정과 대화, 갈등을 만든다. 그렇기에 만약 팀이 서로 불신하는 상황이라면, 엔지니어링 스킬보다 정치에 더 집중하는 것이 낫다.

### 테스트를 나중에 작성하는 것의 대가

만약 테스트를 나중에 붙인다면 확실히 실패하는 상황에서 성공하는 상황으로 전환한건지, 우연히 성공하는 상태에 코드를 더한건지 알기가 어렵다. 테스트 코드를 작성하고 테스트가 실패하는 것을 확인하지 않고 사소한 실수를 놓친다면 나중에 발견할 수록 더 큰 대가를 치러야 한다. 그리고 테스트 체계가 없는 상황에서는 마구잡이로 실행해보고 우연히 버그를 찾아내는 식으로 개발이 진행되기 때문에 불안정한 상태가 지속된다.

### 테스트가 어려워지는 이유

분석/설계가 미흡한 경우, 테스트가 어려울 수 있다. 만들어야 하는 것이 무엇인지 정확하게 표현할 수 없다면 테스트 역시 작성하기 어렵다. 다른 이유로는 개발자가 직접 결정해야 하는 문제인 경우를 들 수 있다. 정확한 원인이 무엇인지 추측하는 것이 필요하다.

## 참고자료

- [GitHub/ahastudio: TDD](https://github.com/ahastudio/til/blob/main/agile/test-driven-development.md)
- [GitHub/ahastudio: TDD, FAQ](https://github.com/ahastudio/til/blob/main/blog/2016/12-03-tdd-faq.md)
- [GitHub/ahastudio: Simple Example](https://github.com/ahastudio/til/blob/main/jest/20201204-simple-tdd-example.md)
- [GitHub/ahastudio: Given When Then 패턴](https://github.com/ahastudio/til/blob/main/blog/2018/12-08-given-when-then.md)
